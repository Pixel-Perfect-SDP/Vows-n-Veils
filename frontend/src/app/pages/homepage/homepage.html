<section class="homepage-section">

  <section class="loading-container" *ngIf="hasEvent === null">
    <section class="Loading-1"></section>
    <section class="Loading-2"></section>
  </section>

  <!-- If user DOES have an event -->
  <section class="has-event" *ngIf="hasEvent && eventData">

    <!-- CSS-ONLY SIDEBAR TOGGLE (no TS needed) -->
    <input id="sb-toggle" type="checkbox" class="sb-toggle" aria-label="Toggle sidebar" />

    <!-- Sidebar -->
    <nav class="sidebar">
      <section class="sidebar-header">
        <img src="assets/logo.jpg" alt="Vows & Veils logo" class="logo" />
        <h1>Vows & Veils</h1>
      </section>
      <ul>
        <li>
          <a href="#" [class.active]="activeTab==='guests'" (click)="switchToGuests($event)">Guest List</a>
        </li>
        <li><a routerLink="/invitations" routerLinkActive="active">Invitations</a></li>
        <li><a routerLink="/venues-couples" routerLinkActive="active">Venues</a></li>
        <li><a routerLink="/vendors-couples" routerLinkActive="active">Vendors</a></li>
      </ul>
    </nav>

    <!-- Main content column -->
    <div class="main">

      <!-- Header / event banner lives INSIDE the flow (no overlap) -->
      <header class="event-header">
        <!-- Hamburger -->
        <label for="sb-toggle" class="hamburger" title="Toggle sidebar" aria-label="Toggle sidebar">
          &#9776;
        </label>

        <div class="event-hero">
          <p class="names">Welcome, {{ eventData.Name1 }} and {{ eventData.Name2 }}</p>
        </div>
      </header>

      <!-- Default landing content -->
      <section class="content" *ngIf="activeTab==='overview'">
        <!-- your overview content -->
      </section>

      <!-- Guest list panel -->
      <section class="content" *ngIf="activeTab==='guests'">
        <h2>Guest List</h2>

        <!-- Filters row -->
        <div class="filters-row">
          <div class="filter">
            <label>Dietary</label>
            <select [(ngModel)]="selectedDietary" (change)="onFiltersChange()">
              <option [ngValue]="null">All</option>
              <option *ngFor="let d of dietaryOptions" [value]="d">{{ d }}</option>
            </select>
          </div>

          <div class="filter">
            <label>Allergies</label>
            <select [(ngModel)]="selectedAllergy" (change)="onFiltersChange()">
              <option [ngValue]="null">All</option>
              <option *ngFor="let a of allergyOptions" [value]="a">{{ a }}</option>
            </select>
          </div>

          <div class="filter">
            <label>RSVP</label>
            <select [(ngModel)]="selectedRsvp" (change)="onFiltersChange()">
              <option value="all">All</option>
              <option value="true">Attending</option>
              <option value="false">Not Attending</option>
            </select>
          </div>
        </div>

        <div *ngIf="guestsLoading">Loading guestsâ€¦</div>
        <div *ngIf="guestsError && !guestsLoading" class="error">{{ guestsError }}</div>

        <table *ngIf="!guestsLoading && !guestsError && guests?.length" class="guest-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Dietary</th>
              <th>Allergies</th>
              <th>RSVP</th>
              <th>Song</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let g of guests">
              <td>{{ g.Name }}</td>
              <td>{{ g.Email }}</td>
              <td>{{ g.Dietary }}</td>
              <td>{{ g.Allergies }}</td>
              <td>{{ g.RSVPstatus ? 'Yes' : 'No' }}</td>
              <td>{{ g.Song }}</td>
            </tr>
          </tbody>
        </table>

        <p *ngIf="!guestsLoading && !guestsError && !guests?.length">No guests yet.</p>
      </section>


    </div><!-- /.main -->
  </section><!-- /.has-event -->
</section>



<!-- if user doesnt have an event: -->
 <!-- show create event page -->
<section class="create-event" *ngIf="hasEvent === false">
  <section class="event-card">
  <img src="assets/logo.jpg" alt="Vows & Veils logo" class="logo" />
  <h2>Plan your wedding</h2>
  <p>Fill in the details below to get started!</p>
  </section>

<section class="event-form">
  <form [formGroup]="form" (ngSubmit)="createEvent()">
    <label>Name of first partner:</label>
    <input formControlName="name1" />

    <label>Name of second partner:</label>
    <input formControlName="name2" />

    <label>Date of wedding:</label>
    <input type="date" formControlName="date" />

    <label>Time of wedding:</label>
    <input type="time" formControlName="time" />

    <button type="submit" [disabled]="form.invalid">Create our wedding</button>
  </form>
</section>
</section>